
# purpose: update all git directories on this system

VERSION=1.0.3
SKIPFILE=upd_skip
ROOT_DIR=/
if [ -d /cygdrive ]; then
    ROOT_DIR=/cygdrive
fi

find $ROOT_DIR -type d -name .git 2>/dev/null | while read a
do
    cd "$a/.."

    if [ -f $SKIPFILE ]; then
        echo "(skipping $a)"
        continue
    fi

    status=$(git status -s 2>&1)
    status_status=$?
    pull=$(git pull 2>&1)
    pull_status=$?

    push=$(git push origin master 2>&1)
    push_status=$?


    if [[ $pull =~ No\ remote\ repository\ specified ]] ; then
        touch $SKIPFILE
        echo "(skipping $a)"
        continue
    fi

    echo
    echo "===== $a"
    if [ -n "$status" ]; then
        echo "$status"
    fi
    echo "$pull"
    echo "$push"
    echo

done

cmp ~/.vimrc ~/.vim/_vimrc
diff ~/.vimrc ~/.vim/_vimrc
cmp ~/.bash_profile ~/bin/_bash_profile
diff ~/.bash_profile ~/bin/_bash_profile
